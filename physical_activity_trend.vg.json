{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": "Physical Inactivity Trends",
  "width": 700,
  "height": 600,
  "params": [
    {
      "name": "CountryFilter",
      "value": "Key Countries",
      "bind": {
        "input": "select",
        "name": "Select Country: ",
        "options": [
          "Key Countries",
          "United States of America",
          "China",
          "India",
          "Brazil",
          "Germany",
          "United Kingdom of Great Britain and Northern Ireland",
          "Canada",
          "Australia",
          "Republic of Korea",
          "Philippines",
          "Italy",
          "Bangladesh",
          "France",
          "Russian Federation",
          "Mexico",
          "Spain"
        ],
        "labels": [
          "Key Countries (Default)",
          "United States",
          "China",
          "India",
          "Brazil",
          "Germany",
          "United Kingdom",
          "Canada",
          "Australia",
          "South Korea",
          "Philippines",
          "Italy",
          "Bangladesh",
          "France",
          "Russia",
          "Mexico",
          "Spain"
        ]
      }
    }
  ],
  "data": {"url": "data/physical_activity_insufficient_11-17.csv"},
  "transform": [
    {
      "filter": "CountryFilter == 'Key Countries' ? (datum.Location == 'United States of America' || datum.Location == 'Republic of Korea' || datum.Location == 'Philippines' || datum.Location == 'Australia' || datum.Location == 'Italy' || datum.Location == 'Bangladesh' || datum.Location == 'India' || datum.Location == 'China') : (datum.Location == CountryFilter)"
    }
  ],
  "vconcat": [
    {
      "title": "Focus View",
      "width": 700,
      "height": 380,

      "encoding": {
        "x": {
          "field": "Period",
          "type": "temporal",
          "title": "Year",
          "scale": {"domain": {"param": "brush"}}
        },
        "y": {
          "field": "FactValueNumeric",
          "type": "quantitative",
          "title": "Physically inactive (%)",
          "scale": {"domain": [0, 100]}
        }
      },

      "layer": [
        {
          "mark": {"type": "line", "point": true, "strokeWidth": 3},
          "encoding": {
            "color": {
              "field": "Location",
              "type": "nominal",
              "title": "Country",
              "scale": {
                "range": ["#1f77b4", "#ff7f0e", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf", "#aec7e8", "#ffbb78", "#c5b0d5", "#c49c94", "#f7b6d3", "#c7c7c7", "#dbdb8d", "#9edae5", "#393b79", "#6b6ecf", "#9c9ede", "#b5cf6b"]
              }
            },
            "tooltip": [
              {"field": "Location", "title": "Country"},
              {"field": "Period", "title": "Year", "type": "temporal", "format": "%Y"},
              {"field": "FactValueNumeric", "title": "Inactivity (%)", "format": ".1f"}
            ]
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "right",
            "dx": -10,
            "dy": -15,
            "fontSize": 10,
            "color": "#7f8c8d",
            "fontWeight": "600",
            "opacity": {"expr": "CountryFilter === 'Key Countries' ? 1 : 0"}
          },
          "encoding": {
            "x": {"datum": {"year": 2016}},
            "y": {"datum": 94.2},
            "text": {"value": "Highest: South Korea 94.2%"}
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "right",
            "dx": -10,
            "dy": 15,
            "fontSize": 10,
            "color": "#7f8c8d",
            "fontWeight": "600",
            "opacity": {"expr": "CountryFilter === 'Key Countries' ? 1 : 0"}
          },
          "encoding": {
            "x": {"datum": {"year": 2016}},
            "y": {"datum": 66.1},
            "text": {"value": "Lowest: Bangladesh 66.1%"}
          }
        }
      ]
    },
    {
      "title": "Context View (Brush to Zoom)",
      "width": 700,
      "height": 150,
      "params": [
        {
          "name": "brush",
          "select": {"type": "interval", "encodings": ["x"]}
        }
      ],
      "mark": {"type": "line", "point": true, "strokeWidth": 1, "opacity": 0.7},
      "encoding": {
        "x": {"field": "Period", "type": "temporal", "title": ""},
        "y": {
          "field": "FactValueNumeric",
          "type": "quantitative",
          "title": "",
          "scale": {"domain": [0, 100]}
        },
        "color": {
          "field": "Location",
          "type": "nominal",
          "scale": {
            "range": ["#1f77b4", "#ff7f0e", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf", "#aec7e8", "#ffbb78", "#c5b0d5", "#c49c94", "#f7b6d3", "#c7c7c7", "#dbdb8d", "#9edae5", "#393b79", "#6b6ecf", "#9c9ede", "#b5cf6b"]
          }
        },
        "opacity": {
          "condition": {"param": "brush", "value": 0.3},
          "value": 0.1
        }
      }
    }
  ]
}
